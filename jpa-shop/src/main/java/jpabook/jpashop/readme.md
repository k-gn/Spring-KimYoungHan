## 연관관계 매핑

- 용어
    - 방향 : 양방향, 단방향
    - 다중성 : 다대일, 일대다, 일대일, 다대다
    - 연관관계의 주인 : 양방향 연관관계는 주인이 필요 (mappedBy, Many-외래키가 있는 쪽이 주인이다.)
        - 두 객체 연관관계 중 하나를 정해서 테이블의 외래키를 관리해야 하는데 이것을 연관관계의 주인(Owner)이라고 한다.
    
* 가급적 안시 표준 조인을 사용해야 다른 데이터베이스로 바꿔도 무리가 없다.

- 객체를 테이블에 맞추어 데이터 중심으로 모델링하면 협력 관계를 만들 수 없다.
    - 테이블은 외래키로 조인을 사용해 연관된 테이블을 찾는다.
    - 객체는 참조를 사용해 연관된 객체를 찾는다.
    
---

- @ManyToOne
    - @JoinColumn(name = "FK_ID") (생략 가능)
- @OneToMany (@JoinColumn을 꼭 사용해야 한다. 그렇지 않으면 조인 테이블 방식을 사용한다.(중간에 테이블을 하나 추가한다.))
    - @JoinColumn(name = "FK_ID")
    - @OneToMany 를 추가하고 양방향 매핑을 사용하면 연관 관계의 주인을 mappedBy 로 지정 (대상이 되는 변수명)
    
- 기본적으로 단방향 매핑으로 하고 나중에 역방향으로 객체 탐색이 꼭 필요하다고 느낄 때 추가한다. (N쪽이 연관관계의 주인)
- 순수한 객체까지 고려한 연관관계로 객체 관점에서 양쪽에 모두 값을 넣어주는 것이 안전하다.

--- 

- 일대다 단방향 매핑의 문제는, 매핑한 객체가 관리하는 외래 키가 다른 테이블에 있다는점 -> 관리가 어렵다.
- 가끔 JPA 값 타입을 사용하는 것을 대신하여 사용할 때는 유용한 경우가 있다.
- 일대다 단방향 매핑보다는 다대일 양방향 매핑을 사용하는 것을 권장
- 사실 일대다 양방향 매핑은 존재하지 않음.
